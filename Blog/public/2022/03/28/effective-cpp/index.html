<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Programming,">





  <link rel="alternate" href="/atom.xml" title="timemeansalot" type="application/atom+xml">






<meta name="description" content="学习《Effective C++》的读书笔记">
<meta name="keywords" content="Programming">
<meta property="og:type" content="article">
<meta property="og:title" content="effective_cpp">
<meta property="og:url" content="http://timemeansalot.github.io/2022/03/28/effective-cpp/index.html">
<meta property="og:site_name" content="timemeansalot">
<meta property="og:description" content="学习《Effective C++》的读书笔记">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2022-04-05T15:14:25.986Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="effective_cpp">
<meta name="twitter:description" content="学习《Effective C++》的读书笔记">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://timemeansalot.github.io/2022/03/28/effective-cpp/">







  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "4a702b6a"
    });
  daovoice('update');
  </script>

  <title>effective_cpp | timemeansalot</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">


  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/abetterus?tab=repositories" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#FD6C6C; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">timemeansalot</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">努力、奋斗</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://timemeansalot.github.io/2022/03/28/effective-cpp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FuJie">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://s2.ax1x.com/2019/03/19/AuQxUJ.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="timemeansalot">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">effective_cpp</h1>
        

        <div class="post-meta">

          
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-03-28T14:26:03+08:00">
                2022-03-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2022/03/28/effective-cpp/" class="leancloud_visitors" data-flag-title="effective_cpp">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.6k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  10
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>学习《Effective C++》的读书笔记</p>
<a id="more"></a>
<h2 id="Item-4-always-initialize-object-before-using-it"><a href="#Item-4-always-initialize-object-before-using-it" class="headerlink" title="Item 4: always initialize object before using it"></a>Item 4: always initialize object before using it</h2><ol>
<li>manually initialize all built-in type</li>
<li>use <strong>initialization list</strong> to initialize data members in class when writing constructors for class.</li>
<li>use a function which returns the reference of (this can make the <strong>non-local static variable</strong> become local static variable), instead of directly use non-local static variable itself. So the initialization of the local static variable will happen when the corresponding function is called. However the <u>initialization order of two non-local static variable declared in two translation unit is unknow,</u> which could be disastrous.</li>
</ol>
<h1 id="Chapter-2-Constructors-Destructors-and-Assignment-Operations"><a href="#Chapter-2-Constructors-Destructors-and-Assignment-Operations" class="headerlink" title="Chapter 2. Constructors, Destructors and Assignment Operations"></a>Chapter 2. Constructors, Destructors and Assignment Operations</h1><h2 id="Item-5-Know-what-functions-C-silently-writes-and-calls"><a href="#Item-5-Know-what-functions-C-silently-writes-and-calls" class="headerlink" title="Item 5: Know what functions C++ silently writes and calls"></a>Item 5: Know what functions C++ silently writes and calls</h2><blockquote>
<p>If we don’t create, C++ compiler will declares <strong>constructor, copy constructor, destructor and copy assignment operator</strong> for us. If we would use these functions in our code, the compiler will write these functions for us.</p>
</blockquote>
<h2 id="Item-6-Explicitly-disallow-the-use-of-compiler-generated-functions"><a href="#Item-6-Explicitly-disallow-the-use-of-compiler-generated-functions" class="headerlink" title="Item 6: Explicitly disallow the use of compiler generated functions"></a>Item 6: Explicitly disallow the use of compiler generated functions</h2><p>Just as mentions in Item5, the compiler would automatically create functions for us, what can we do if <strong>we don’t want the compiler to create</strong> some of such classes? </p>
<p>For example, we want to make the copy of two objects illegal, but the compiler will always make a copy constructor and copy assignment operator for our class.</p>
<ul>
<li>The way to make copy of objects illegal is that <strong>we can manually define copy constructor and copy assignment operation, but we defined them as private.</strong> So the copy function cannot be called</li>
<li>Moreover, if you <strong>don’t provide function definition</strong> for your manually defined copy function, then you can’t even call them using class member function, you will get a link error.</li>
<li>You can create a base class who declared the copy function as private and doesn’t provide function body. Then every <strong>class inherits from this base class is not allow to copy.</strong></li>
</ul>
<h2 id="Item-7-Declare-destructors-virtual-in-polymorphic-base-classes"><a href="#Item-7-Declare-destructors-virtual-in-polymorphic-base-classes" class="headerlink" title="Item 7: Declare destructors virtual in polymorphic base classes"></a>Item 7: Declare destructors virtual in polymorphic base classes</h2><p>If you want to use pointer of parent class to access child objects, you must declare the parent destructor as virtual. If you don’t do that, when you try to free the child object using the parent pointer, you can only delete the members inherited from parent class, you can’t delete the members of the child class.</p>
<ul>
<li>If you want to delete all members in child object using parent pointer, you must declare parent’s destructor as virtual.</li>
<li>It’s bad to inherit from a parent class who doesn’t provide virtual destructor.</li>
<li>You can make an <strong>abstract class</strong> by declare it’s destructor as a <strong>pure virtual destructor</strong>. But you have to provide the definition of that destructor outside the class.</li>
</ul>
<h2 id="Item-8-Prevent-exceptions-from-leaving-destructors"><a href="#Item-8-Prevent-exceptions-from-leaving-destructors" class="headerlink" title="Item 8: Prevent exceptions from leaving destructors"></a>Item 8: Prevent exceptions from leaving destructors</h2><ol>
<li>Can’t emit exceptions in destructor: If an error is thrown in destructor, It will probably make the process to free resources fail.</li>
<li>Make a client class to deal with the exceptions, you can make a <strong>non-destruct function</strong> to handle with exceptions and you can handle exceptions in the destructor of client class.</li>
</ol>
<h2 id="Item-9-Never-call-virtual-functions-during-construction-or-destruction"><a href="#Item-9-Never-call-virtual-functions-during-construction-or-destruction" class="headerlink" title="Item 9: Never call virtual functions during construction or destruction"></a>Item 9: Never call virtual functions during construction or destruction</h2><ol>
<li>Don’t call virtual function in a constructor or destructor. Because if you make a constructor of parent class call a virtual function, and you think it’s going to call the function of derived class. However, it can only call the virtual function in parent class itself. Because when we call the constructor of parent class, the derived class has not been defined yet, how could we call the function defined in derived class?</li>
<li>We can pass back information to parent class from child class for different derived class, so they can have different behavior.</li>
<li><strong>Static</strong> functions can only modify static members of the class; it’s shared by all objects of that class; it’s called by class_name::function_name</li>
</ol>
<h2 id="Item-10-Have-assignment-operation-return-a-reference-to-this"><a href="#Item-10-Have-assignment-operation-return-a-reference-to-this" class="headerlink" title="Item 10: Have assignment operation return a reference to *this"></a>Item 10: Have assignment operation return a reference to *this</h2><p>The assign operation in C++ to the right first, for example a=b=c=15, C++ first make c=15, them assign b=c, then assign a=b.</p>
<p>When we do operator override, the assignment operation must return *this.</p>
<h2 id="Item-11-Handle-assignment-to-self-in-operator"><a href="#Item-11-Handle-assignment-to-self-in-operator" class="headerlink" title="Item 11: Handle assignment to self in operator="></a>Item 11: Handle assignment to self in operator=</h2><p>When we write operator= for a class, we have to make sure the function forms well when we do <strong>a=a</strong>, which a is an instance of the class. There are 3 ways to assignment error and exception error:</p>
<ol>
<li>compare resource address and target address</li>
<li>allocate new resource before delete old resource</li>
<li>use <em>copy and swap</em> technical</li>
</ol>
<h2 id="Item-12-Copy-all-parts-of-an-object"><a href="#Item-12-Copy-all-parts-of-an-object" class="headerlink" title="Item 12: Copy all parts of an object"></a>Item 12: Copy all parts of an object</h2><blockquote>
<p>Return reference in copy assignment operation can reduce of “copy constructor and destructor”. Because if we return value in copy assignment operation, we have use copy constructor to copy the object in copy assignment function to the left value of =. For example</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define class food</span></span><br><span class="line">food f1;</span><br><span class="line">food f2=f1;</span><br></pre></td></tr></table></figure>
<p>In the code above, if we pass by value in copy assignment function: the object created in the copy function must be copied to f2 by copy constructor, and the object inside copy assignment must be freed by calling destructor. However, if we pass by reference in copy assignment, the call of <em>copy constructor and destructor</em> can be reduced.</p>
<ol>
<li>copy all members in class. If you have add new members, you have to modify your copy constructor and copy assignment operator.</li>
<li>call copy functions of parent class when writing copy functions for child class.</li>
<li><em>never</em> call copy constructor in copy assignment operation, vise versa. Even they are very similar with each other. You can put the common parts of the two functions into a third function name <em>Init</em>, then both the copy constructor and copy assignment operator can call the Init function.</li>
</ol>
<h1 id="Chapter-3-Resource-Management"><a href="#Chapter-3-Resource-Management" class="headerlink" title="Chapter 3. Resource Management"></a>Chapter 3. Resource Management</h1><p>Resources are something you must free after finishing using them.</p>
<h2 id="Item-13-Using-objects-to-manage-resources"><a href="#Item-13-Using-objects-to-manage-resources" class="headerlink" title="Item 13: Using objects to manage resources"></a>Item 13: Using objects to manage resources</h2><p>Because we have to delete the resource after using it. However, we can’t make sure our code can reach the <em>delete sentence</em>. We have to use objects to manager resources in order to use the destructor to release the resource(C++ make sure the destructor can always be executed.) <strong>This is called RAII(resource acquisition is initialization).</strong></p>
<ol>
<li>auto_pointer is a pointer who will automatic call the delete function of the object which it points to. There can be only one auto_pointer pointed to the same object–&gt; When copy one auto_pointer to another, the original copy_pointer will be destroyed–&gt; Auto_pointers can’t be stored in C++ containers, because C++ containers require the contents exhibit “normal copy behavior”.</li>
<li>reference-counting smart pointers(RCSP) will count how much copy of the pointer. If there is zero copy of the RCSP pointer, it will call the delete function of the object which it points to to release resource.</li>
</ol>
<h2 id="Item-14-Think-carefully-about-copying-behavior-in-resource-managing-classes"><a href="#Item-14-Think-carefully-about-copying-behavior-in-resource-managing-classes" class="headerlink" title="Item 14: Think carefully about copying behavior in resource-managing classes"></a>Item 14: Think carefully about copying behavior in resource-managing classes</h2><ol>
<li>Coping an RAII object entails copying the resource it manages.</li>
</ol>
<h2 id="Item-15-Provide-access-to-raw-resources-in-resource-managing-classes"><a href="#Item-15-Provide-access-to-raw-resources-in-resource-managing-classes" class="headerlink" title="Item 15: Provide access to raw resources in resource-managing classes"></a>Item 15: Provide access to raw resources in resource-managing classes</h2><ol>
<li>APIs often require access to raw resources, so each RAII class should offer a way to get at the resource it manages.</li>
<li>Access may be via explicit or implicit conversion, explicit conversion is more safe while implicit conversion is more convenient for clients.</li>
</ol>
<h2 id="Item-16-Use-the-same-form-in-corresponding-uses-of-new-and-delete"><a href="#Item-16-Use-the-same-form-in-corresponding-uses-of-new-and-delete" class="headerlink" title="Item 16: Use the same form in corresponding uses of new and delete"></a>Item 16: Use the same form in corresponding uses of new and delete</h2><ol>
<li>if use [ ] in <em>new</em> expression, use [ ] in <em>delete expression</em>, if don’t use [ ] in <em>new</em> expression, don’t use [ ] in <em>delete expression</em>.</li>
</ol>
<h2 id="Item-17-Store-new-ed-objects-in-smart-pointers-in-standard-statements"><a href="#Item-17-Store-new-ed-objects-in-smart-pointers-in-standard-statements" class="headerlink" title="Item 17: Store new_ed objects in smart pointers in standard statements"></a>Item 17: Store new_ed objects in smart pointers in standard statements</h2><ol>
<li>Failure to do this can lead to subtle resource leaks when exceptions are thrown.</li>
</ol>
<h1 id="Chapter-4-Designs-and-Declarations"><a href="#Chapter-4-Designs-and-Declarations" class="headerlink" title="Chapter 4. Designs and Declarations"></a>Chapter 4. Designs and Declarations</h1><h2 id="Item-18-make-interfaces-easy-to-use-correctly-and-hard-to-use-incorrectly"><a href="#Item-18-make-interfaces-easy-to-use-correctly-and-hard-to-use-incorrectly" class="headerlink" title="Item 18: make interfaces easy to use correctly and hard to use incorrectly"></a>Item 18: make interfaces easy to use correctly and hard to use incorrectly</h2><ol>
<li>Good interfaces are easy to use correctly and hard to use incorrectlly.</li>
<li>Prevent error include consistency in interfaces and behave compatibility with build-in types.</li>
</ol>
<h2 id="Item-19-Treat-class-design-as-type-design"><a href="#Item-19-Treat-class-design-as-type-design" class="headerlink" title="Item 19: Treat class design as type design"></a>Item 19: Treat class design as type design</h2><p>Class design is type design. Before defining a new type, be sure to consider all the issues discussed in this item.</p>
<h2 id="Item-20-Prefer-pass-by-reference-to-const-to-pass-by-value"><a href="#Item-20-Prefer-pass-by-reference-to-const-to-pass-by-value" class="headerlink" title="Item 20: Prefer pass-by-reference-to-const to pass-by-value"></a>Item 20: Prefer pass-by-reference-to-const to pass-by-value</h2><ol>
<li>For user defined type, it’s more efficient to pass-by-reference-const than pass-by-value. Because pass by reference will not create new object, so no copy constructor or destructor are used.</li>
<li><em>Slicing problem:</em> If you pass by value and set parameter as parent class type, when you put a child child object to that function, only the parent class part can be copied while the child class part will be drop. </li>
<li>For build-in type, STL iterator and function object type, it’s more convenient to pass-by-value, they are easy to copy.</li>
<li>Pass-by-value are indeed pass <strong>pointers</strong>.</li>
</ol>
<h2 id="Item-21-Don’t-try-to-return-a-reference-when-you-must-return-an-object"><a href="#Item-21-Don’t-try-to-return-a-reference-when-you-must-return-an-object" class="headerlink" title="Item 21: Don’t try to return a reference when you must return an object"></a>Item 21: Don’t try to return a reference when you must return an object</h2><p>Don’t pass reference to objects that not exists.</p>
<ol>
<li>Any function return a pointer or reference to a local object is not allowed, because local object will be destroyed when the function exits.</li>
<li>Don’t return reference of pointer to static local object, though they will not be destroyed, but there could be an issue if more than one of that object is needed.</li>
</ol>
<h2 id="Item-22-Declared-data-members-private"><a href="#Item-22-Declared-data-members-private" class="headerlink" title="Item 22: Declared data members private"></a>Item 22: Declared data members private</h2><ol>
<li>Hiding data members behind function can easily control the read and write access of data member</li>
<li>If you make clients access data members directly, your ability to change anything public is extremely restricted. Because to much clients code will broken if you make a change to your class.</li>
<li>In fact, protected data members are no more encapsulated than public data members.</li>
</ol>
<h2 id="Item-23-Prefer-non-member-function-to-member-function"><a href="#Item-23-Prefer-non-member-function-to-member-function" class="headerlink" title="Item 23: Prefer non-member function to member function"></a>Item 23: Prefer non-member function to member function</h2><p>Although encapsulation is very import in C++, if will define to much member function, it’s an harm to encapsulation.</p>
<p><strong>The more client can see inside a class, the better encapsulation the class has.</strong> non-member functions can increase encapsulation, flexibility, and extensibility.</p>

      
    </div>
    
    
    

    

    <div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束,感谢您的阅读-------------</div>
    
</div>
  
</div>

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Programming/" rel="tag"><i class="fa fa-tag"></i> Programming</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/03/24/algorithm-sort/" rel="next" title="algorithm_sort">
                <i class="fa fa-chevron-left"></i> algorithm_sort
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2022/04/04/STL/" rel="prev" title="STL Notes">
                STL Notes <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://s2.ax1x.com/2019/03/19/AuQxUJ.jpg" alt="FuJie">
            
              <p class="site-author-name" itemprop="name">FuJie</p>
              <p class="site-description motion-element" itemprop="description">一定很牛逼的我们</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:dtsmallangel@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://space.bilibili.com/50771145" target="_blank" title="哔哩哔哩">
                      
                        <i class="fa fa-fw fa-tv"></i>哔哩哔哩</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/5855697347/profile?topnav=1&wvr=6" target="_blank" title="微博">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
            </div>
          

          
          

          
    
      <div class="links-of-blogroll motion-element links-of-blogroll-inline">
        <div class="links-of-blogroll-title">
          <i class="fa  fa-fw fa-link"></i>
          推荐阅读&nbsp;
          <i class="fa  fa-fw fa-link"></i>
        </div>
        <ul class="links-of-blogroll-list">
          
            <li class="links-of-blogroll-item">
              <a href="https://abetterus.github.io/2019/03/10/Diary/" title="每日趣事" target="_blank">每日趣事</a>
            </li>
          
            <li class="links-of-blogroll-item">
              <a href="https://abetterus.github.io/about/" title="自我介绍" target="_blank">自我介绍</a>
            </li>
          
        </ul>
         
<div id="days"></div>

<script language="javascript">
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("12/4/2018 00:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="在一起"+daysold+"天"+hrsold+"时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>

      </div>
     


          
<div id="days"></div>

<script language="javascript">
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("12/4/2018 00:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="在一起"+daysold+"天"+hrsold+"时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-4-always-initialize-object-before-using-it"><span class="nav-number">1.</span> <span class="nav-text">Item 4: always initialize object before using it</span></a></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-2-Constructors-Destructors-and-Assignment-Operations"><span class="nav-number"></span> <span class="nav-text">Chapter 2. Constructors, Destructors and Assignment Operations</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-5-Know-what-functions-C-silently-writes-and-calls"><span class="nav-number">1.</span> <span class="nav-text">Item 5: Know what functions C++ silently writes and calls</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-6-Explicitly-disallow-the-use-of-compiler-generated-functions"><span class="nav-number">2.</span> <span class="nav-text">Item 6: Explicitly disallow the use of compiler generated functions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-7-Declare-destructors-virtual-in-polymorphic-base-classes"><span class="nav-number">3.</span> <span class="nav-text">Item 7: Declare destructors virtual in polymorphic base classes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-8-Prevent-exceptions-from-leaving-destructors"><span class="nav-number">4.</span> <span class="nav-text">Item 8: Prevent exceptions from leaving destructors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-9-Never-call-virtual-functions-during-construction-or-destruction"><span class="nav-number">5.</span> <span class="nav-text">Item 9: Never call virtual functions during construction or destruction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-10-Have-assignment-operation-return-a-reference-to-this"><span class="nav-number">6.</span> <span class="nav-text">Item 10: Have assignment operation return a reference to *this</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-11-Handle-assignment-to-self-in-operator"><span class="nav-number">7.</span> <span class="nav-text">Item 11: Handle assignment to self in operator=</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-12-Copy-all-parts-of-an-object"><span class="nav-number">8.</span> <span class="nav-text">Item 12: Copy all parts of an object</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-3-Resource-Management"><span class="nav-number"></span> <span class="nav-text">Chapter 3. Resource Management</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-13-Using-objects-to-manage-resources"><span class="nav-number">1.</span> <span class="nav-text">Item 13: Using objects to manage resources</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-14-Think-carefully-about-copying-behavior-in-resource-managing-classes"><span class="nav-number">2.</span> <span class="nav-text">Item 14: Think carefully about copying behavior in resource-managing classes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-15-Provide-access-to-raw-resources-in-resource-managing-classes"><span class="nav-number">3.</span> <span class="nav-text">Item 15: Provide access to raw resources in resource-managing classes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-16-Use-the-same-form-in-corresponding-uses-of-new-and-delete"><span class="nav-number">4.</span> <span class="nav-text">Item 16: Use the same form in corresponding uses of new and delete</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-17-Store-new-ed-objects-in-smart-pointers-in-standard-statements"><span class="nav-number">5.</span> <span class="nav-text">Item 17: Store new_ed objects in smart pointers in standard statements</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Chapter-4-Designs-and-Declarations"><span class="nav-number"></span> <span class="nav-text">Chapter 4. Designs and Declarations</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-18-make-interfaces-easy-to-use-correctly-and-hard-to-use-incorrectly"><span class="nav-number">1.</span> <span class="nav-text">Item 18: make interfaces easy to use correctly and hard to use incorrectly</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-19-Treat-class-design-as-type-design"><span class="nav-number">2.</span> <span class="nav-text">Item 19: Treat class design as type design</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-20-Prefer-pass-by-reference-to-const-to-pass-by-value"><span class="nav-number">3.</span> <span class="nav-text">Item 20: Prefer pass-by-reference-to-const to pass-by-value</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-21-Don’t-try-to-return-a-reference-when-you-must-return-an-object"><span class="nav-number">4.</span> <span class="nav-text">Item 21: Don’t try to return a reference when you must return an object</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-22-Declared-data-members-private"><span class="nav-number">5.</span> <span class="nav-text">Item 22: Declared data members private</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Item-23-Prefer-non-member-function-to-member-function"><span class="nav-number">6.</span> <span class="nav-text">Item 23: Prefer non-member function to member function</span></a></li></ol></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

      
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anaconda/">Anaconda</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Birthday/">Birthday</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Diary/">Diary</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IC/">IC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming/">Programming</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/">STL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tools/">Tools</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VSCode/">VSCode</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wsl/">wsl</a><span class="tag-list-count">1</span></li></ul>
        </canvas>
    </div>
</div>


    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FuJie</span>

  

    <!--<span class="post-meta-divider">|</span>-->
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">131.1k</span>
  
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>



-->

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("JlmmlgLIdm5LThhukAGumE8H-9Nh9j0Va", "kwjFB7kySUc6WoCKd9e9r2Tb");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
